var Massimp=function(){function f(c,d){d=void 0===d?!0:d;var b=XLSX.read(c,{type:"binary"}),l=[];b.SheetNames.forEach(function(c){var e={};d||(e.header=1);e=XLSX.utils.sheet_to_row_object_array(b.Sheets[c],e);l.push({nome:c,conteudo:e})});return l}function r(c,d,b,l){l=void 0===l?!0:l;var e=new FileReader;e.onload=function(c){try{var e=f(c.target.result,l);d(e)}catch(D){b(D)}};e.onerror=function(c){b(c)};e.readAsBinaryString(c.files[0])}function x(c,b){var d=Object.assign({},c);b.forEach(function(c,
    b){var e=c.from,l=c.to;null!=d[e]&&(d[l]=d[e],delete d[e])});return d}function G(c,d,b){b=void 0===b?null:b;var e=[],h;for(h=0;h<c.length;h++)null!=b?c[h][b]===d&&e.push(h):c[h]===d&&e.push(h);return e}var h=[],y={"en-us":{elementNotFound:"Massimp Error: Element not found",fileWithNoContent:"Massimp Error: File without content",invalidFile:"Massimp Error: Invalid file",noDataProcessed:"Massimp Error: No data was processed",noAttributeAssociated:"Massimp Error: None attribute was associated to any column from file",
    noFileSet:"Massimp Error: No file was set",list:"List",fileChoose:"Choose a file",fileWithHeader:"Header (It has a column title at the 1st line)",fileWithoutHeader:"No Header (It doesn't have a column title at the 1st line)",defaultButtonText:"Do it!",extraButtonText:"Cancel",line:"Line",column:"Column",attribute:"Attribute",open:"Open",close:"Close",change:"Change",remove:"Remove"},"pt-br":{elementNotFound:"Massimp Error: Elemento n\u00e3o encontrado",fileWithNoContent:"Massimp Error: N\u00e3o foi poss\u00edvel encontrar conte\u00fado neste arquivo!",
    invalidFile:"Massimp Error: Arquivo inv\u00e1lido",noDataProcessed:"Massimp Error: Nenhum dado foi processado",noAttributeAssociated:"Massimp Error: Nenhum atributo foi associado \u00e0 nenhuma coluna do arquivo",noFileSet:"Massimp Error: Nenhum arquivo foi selecionado",list:"Lista",fileChoose:"Escolha um arquivo",fileWithHeader:"Com cabe\u00e7alho (Com o t\u00edtulo da coluna na 1\u00aa linha)",fileWithoutHeader:"Sem cabe\u00e7alho (Sem o t\u00edtulo da coluna na 1\u00aa linha)",defaultButtonText:"Processar!",
    extraButtonText:"Cancelar",line:"Linha",column:"Coluna",attribute:"Atributo",open:"Abrir",close:"Fechar",change:"Alterar",remove:"Remover"}};Object.keys(y).forEach(function(c){y[c].languageNotSupported="Massimp Error: Unsupported language"});var z=navigator.language.toLocaleLowerCase()||navigator.userLanguage.toLocaleLowerCase();null!=z&&Object.keys(y).includes(z)||(console.warn("Massimp Warning: Could not use local language, setting English (en-US) as default language."),z="en-us");var w=null,A=
    0,E=!0,u=!1,v=!0,b=new WeakMap,q=function(c,d){var e=this;"string"===typeof c&&(c=document.querySelector(c),c._massimp=this);b.set(this,{element:c,options:d,_getStringList:function(){return y[z.toLocaleLowerCase()]},_loadHTML:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.element.appendChild(this._createFileHTML());this.element.appendChild(this._createRadioHeaderHTML());this.element.appendChild(this._createExcelSheetsHTML());this.element.appendChild(this._createColumnsAssociationsHTML());
    this.element.appendChild(this._createResultHTML());this.element.appendChild(this._createButtonsHTML())},_createFileHTML:function(){var a=this,c=document.createElement("span");c.classList.add("massimp-file-text");c.innerHTML=this._getStringList().list;var b=document.createElement("input");b.classList.add("massimp-file");b.setAttribute("accept",".csv, .xls, .xlsx");b.setAttribute("type","file");var d=document.createElement("div");d.classList.add("massimp-custom-file");d.classList.add("btn");d.classList.add("waves-effect");
    d.classList.add("waves-light");d.classList.add("col");d.classList.add("s1");d.classList.add("m1");d.classList.add("l1");d.appendChild(c);d.appendChild(b);b=document.createElement("input");b.setAttribute("type","text");b.classList.add("massimp-file-label");b.classList.add("file-path");b.placeholder=this._getStringList().fileChoose;b.onclick=function(){var b=a._getInputFileElement();null!=b&&b.click()};c=document.createElement("div");c.classList.add("massimp-file-group-append");c.classList.add("file-path-wrapper");
    c.classList.add("col");c.classList.add("s9");c.classList.add("m9");c.classList.add("l9");c.appendChild(b);var e=document.createElement("button");e.setAttribute("type","button");e.classList.add("btn-flat");e.classList.add("waves-effect");e.classList.add("waves-light");e.classList.add("red-text");e.innerHTML="&#10006;";b=document.createElement("div");b.classList.add("massimp-file-group-clean");b.classList.add("col");b.classList.add("s2");b.classList.add("m2");b.classList.add("l2");b.setAttribute("title",
    this._getStringList().close);b.style.display="none";b.style.lineHeight="6vh";b.appendChild(e);e=document.createElement("div");e.classList.add("massimp-file-group");e.classList.add("file-field");e.classList.add("input-field");e.classList.add("row");e.style.marginBottom="30px";e.appendChild(d);e.appendChild(c);e.appendChild(b);return e},_createRadioHeaderHTML:function(){var a=document.createElement("input");a.setAttribute("type","radio");a.setAttribute("checked","true");a.name="massimp-has-header";
    a.value="true";a.classList.add("with-gap");var b=document.createElement("span");b.classList.add("black-text");b.innerHTML=this._getStringList().fileWithHeader;var c=document.createElement("label");c.classList.add("massimp-radio");c.style.marginRight="1rem";c.appendChild(a);c.appendChild(b);b=document.createElement("input");b.setAttribute("type","radio");b.name="massimp-has-header";b.value="false";b.classList.add("with-gap");var d=document.createElement("span");d.classList.add("black-text");d.innerHTML=
    this._getStringList().fileWithoutHeader;a=document.createElement("label");a.classList.add("massimp-radio");a.style.marginRight="1rem";a.appendChild(b);a.appendChild(d);b=document.createElement("div");b.classList.add("massimp-radio-group");b.appendChild(c);b.appendChild(a);return b},_createExcelSheetsHTML:function(){var a=document.createElement("div");a.classList.add("massimp-excel-sheets");a.style.paddingBottom="30px";a.style.display="none";return a},_createColumnsAssociationsHTML:function(){var a=
    document.createElement("thead"),b=document.createElement("tbody"),c=document.createElement("table");c.classList.add("responsive-table");c.classList.add("striped");c.appendChild(a);c.appendChild(b);a=document.createElement("div");a.classList.add("massimp-table-group");a.style.marginBottom="30px";a.style.display="none";a.appendChild(c);return a},_createResultHTML:function(){var a=document.createElement("thead"),b=document.createElement("tbody"),c=document.createElement("table");c.classList.add("responsive-table");
    c.classList.add("striped");c.appendChild(a);c.appendChild(b);a=document.createElement("div");a.classList.add("massimp-table-result-group");a.style.marginBottom="30px";a.style.display="none";a.appendChild(c);return a},_createButtonsHTML:function(){var a=document.createElement("button");a.setAttribute("type","button");a.classList.add("btn");a.classList.add("blue");a.classList.add("waves-effect");a.classList.add("waves-light");a.classList.add("massimp-default-button");a.innerHTML=this._getStringList().defaultButtonText;
    var b=document.createElement("div");b.classList.add("massimp-buttons-group");b.appendChild(a);return b},_getInputGroupElement:function(){var a=0<c.getElementsByClassName("massimp-file-group").length?c.getElementsByClassName("massimp-file-group")[0]:null;if(null==a)throw this._getStringList().elementNotFound;return a},_getCustomFileElement:function(){var a=this._getInputGroupElement();if(null!=a){if(a=0<a.getElementsByClassName("massimp-custom-file").length?a.getElementsByClassName("massimp-custom-file")[0]:
    null,null==a)throw this._getStringList().elementNotFound;}else throw this._getStringList().elementNotFound;return a},_getInputFileTextElement:function(){if(null!=this._getInputGroupElement()){var a=this._getCustomFileElement();if(null!=a){if(a=0<a.getElementsByTagName("span").length?a.getElementsByTagName("span")[0]:null,null==a)throw this._getStringList().elementNotFound;}else throw this._getStringList().elementNotFound;}else throw this._getStringList().elementNotFound;return a},_getInputFileElement:function(){if(null!=
    this._getInputGroupElement()){var a=this._getCustomFileElement();if(null!=a){if(a=0<a.getElementsByTagName("input").length?a.getElementsByTagName("input")[0]:null,null==a)throw this._getStringList().elementNotFound;}else throw this._getStringList().elementNotFound;}else throw this._getStringList().elementNotFound;return a},_getInputFileInsideTextElement:function(){var a=this._getInputGroupElement();if(null!=a)if(a=0<a.getElementsByClassName("massimp-file-group-append").length?a.getElementsByClassName("massimp-file-group-append")[0]:
    null,null!=a){if(a=0<a.getElementsByTagName("input").length?a.getElementsByTagName("input")[0]:null,null==a)throw this._getStringList().elementNotFound;}else throw this._getStringList().elementNotFound;else throw this._getStringList().elementNotFound;return a},_getClearInputFileGroupElement:function(){var a=this._getInputGroupElement();if(null!=a){if(a=0<a.getElementsByClassName("massimp-file-group-clean").length?a.getElementsByClassName("massimp-file-group-clean")[0]:null,null==a)throw this._getStringList().elementNotFound;
    }else throw this._getStringList().elementNotFound;return a},_getClearInputFileElement:function(){if(null!=this._getInputGroupElement()){var a=this._getClearInputFileGroupElement();if(null!=a){if(a=0<a.getElementsByTagName("button").length?a.getElementsByTagName("button")[0]:null,null==a)throw this._getStringList().elementNotFound;}else throw this._getStringList().elementNotFound;}else throw this._getStringList().elementNotFound;return a},_getRadioElements:function(){var a=null,b=null!=document.querySelectorAll(".massimp-radio-group .massimp-radio")?
    document.querySelectorAll(".massimp-radio-group .massimp-radio"):null;if(null!=b)a=[],b.forEach(function(b,c){var d=null!=b.querySelector("input")?b.querySelector("input"):null;if(null!=d)a.push(d);else throw this._getStringList().elementNotFound;});else throw this._getStringList().elementNotFound;return a},_getRadioHasHeaderElement:function(){var a=null!=document.querySelector('input[name="massimp-has-header"]:checked')?document.querySelector('input[name="massimp-has-header"]:checked'):null;if(null==
    a)throw this._getStringList().elementNotFound;return a},_getSheetsRadioElements:function(){var a=0<c.getElementsByClassName("massimp-excel-sheets").length?c.getElementsByClassName("massimp-excel-sheets")[0]:null;if(null==a)throw this._getStringList().elementNotFound;return a},_getTableDivElement:function(){var a=0<c.getElementsByClassName("massimp-table-group").length?c.getElementsByClassName("massimp-table-group")[0]:null;if(null==a)throw this._getStringList().elementNotFound;return a},_getTableBodyElement:function(){var a=
    this._getTableDivElement();if(null!=a)if(a=0<a.getElementsByTagName("table").length?a.getElementsByTagName("table")[0]:null,null!=a){if(a=0<a.getElementsByTagName("tbody").length?a.getElementsByTagName("tbody")[0]:null,null==a)throw this._getStringList().elementNotFound;}else throw this._getStringList().elementNotFound;else throw this._getStringList().elementNotFound;return a},_getTableHeadElement:function(){var a=this._getTableDivElement();if(null!=a)if(a=0<a.getElementsByTagName("table").length?
    a.getElementsByTagName("table")[0]:null,null!=a){if(a=0<a.getElementsByTagName("thead").length?a.getElementsByTagName("thead")[0]:null,null==a)throw this._getStringList().elementNotFound;}else throw this._getStringList().elementNotFound;else throw this._getStringList().elementNotFound;return a},_getTableResultDivElement:function(){var a=0<c.getElementsByClassName("massimp-table-result-group").length?c.getElementsByClassName("massimp-table-result-group")[0]:null;if(null==a)throw this._getStringList().elementNotFound;
    return a},_getTableResultBodyElement:function(){var a=this._getTableResultDivElement();if(null!=a)if(a=0<a.getElementsByTagName("table").length?a.getElementsByTagName("table")[0]:null,null!=a){if(a=0<a.getElementsByTagName("tbody").length?a.getElementsByTagName("tbody")[0]:null,null==a)throw this._getStringList().elementNotFound;}else throw this._getStringList().elementNotFound;else throw this._getStringList().elementNotFound;return a},_getTableResultHeadElement:function(){var a=this._getTableResultDivElement();
    if(null!=a)if(a=0<a.getElementsByTagName("table").length?a.getElementsByTagName("table")[0]:null,null!=a){if(a=0<a.getElementsByTagName("thead").length?a.getElementsByTagName("thead")[0]:null,null==a)throw this._getStringList().elementNotFound;}else throw this._getStringList().elementNotFound;else throw this._getStringList().elementNotFound;return a},_getButtonsGroupElement:function(){var a=0<c.getElementsByClassName("massimp-buttons-group").length?c.getElementsByClassName("massimp-buttons-group")[0]:
    null;if(null==a)throw this._getStringList().elementNotFound;return a},_getDefaultButtonElement:function(){var a=this._getButtonsGroupElement();if(null!=a){if(a=0<a.getElementsByClassName("massimp-default-button").length?a.getElementsByClassName("massimp-default-button")[0]:null,null==a)throw this._getStringList().elementNotFound;}else throw this._getStringList().elementNotFound;return a},_getExtraButtonElement:function(){var a=null,b=this._getButtonsGroupElement();null!=b&&(b=0<b.getElementsByClassName("massimp-extra-button").length?
    b.getElementsByClassName("massimp-extra-button")[0]:null,null!=b&&(a=b));return a},_processFile:function(a,b,c){var d=this;c=void 0===c?null:c;r(a,function(a){if(null!=a&&0<a.length)if(0<a[0].conteudo.length)w=a,c(a);else throw d._getStringList().fileWithNoContent;else throw d._getStringList().invalidFile;},function(a){d._onError(a)},b)},_showColumnAssociationTable:function(a,b){a=void 0===a?!0:a;b=void 0===b?0:b;var c=this._getTableDivElement(),d=this._getTableBodyElement(),e=this._getTableHeadElement();
    if(null!=c&&null!=d&&null!=e){this._removeColumnAssociationTable();var g=document.createElement("tr"),k=document.createElement("th");k.setAttribute("scope","col");k.innerHTML=this._getStringList().line;g.appendChild(k);a&&(k=document.createElement("th"),k.setAttribute("scope","col"),k.innerHTML=this._getStringList().column,g.appendChild(k));k=document.createElement("th");k.setAttribute("scope","col");k.innerHTML=this._getStringList().attribute;g.appendChild(k);e.appendChild(g);Object.keys(w[b].conteudo[0]).forEach(function(b,
    c){var e=document.createElement("th");e.setAttribute("scope",(c+1).toString());e.innerHTML=(c+1).toString();var g=document.createElement("option");g.value="0";g.setAttribute("selected",!0);var t=document.createElement("select");t.classList.add("browser-default");t.classList.add("massimp-column");t.appendChild(g);h.forEach(function(c,d){if(null==c.isImage||0==c.isImage){var e=document.createElement("option");e.value=c.valor;e.innerHTML=c.titulo;!a||b!=c.titulo&&b!=c.valor||e.setAttribute("selected",
    !0);t.appendChild(e)}else u||(u=!0)});g=document.createElement("td");g.classList.add("massimp-attribute-col");g.appendChild(t);var m=document.createElement("tr");m.appendChild(e);if(a){e=document.createElement("span");e.innerHTML=b;var k=document.createElement("td");k.classList.add("massimp-column-col");k.appendChild(e);m.appendChild(k)}m.appendChild(g);d.appendChild(m)});c.style.display=null}},_removeColumnAssociationTable:function(){var a=this._getTableDivElement(),b=this._getTableBodyElement(),
    c=this._getTableHeadElement();if(null!=a&&null!=b){for(;c.firstChild;)c.removeChild(c.firstChild);for(;b.firstChild;)b.removeChild(b.firstChild);a.style.display="none"}},_showSheetSelection:function(a,b){var c=this._getSheetsRadioElements();this._removeSheetSelection();c.appendChild(document.createElement("hr"));a.forEach(function(a,d){var e=document.createElement("input");e.setAttribute("type","radio");e.id="massimp-sheet-"+d.toString();e.setAttribute("name","massimp-sheet");e.setAttribute("value",
    d.toString());e.classList.add("with-gap");0==d&&e.setAttribute("checked",!0);e.onchange=b;var g=document.createElement("span");g.innerHTML=a.nome;var t=document.createElement("label");t.classList.add("massimp-radio");t.appendChild(e);t.appendChild(g);e=document.createElement("p");e.appendChild(t);c.appendChild(e)});c.style.display=null},_removeSheetSelection:function(){var a=this._getSheetsRadioElements();if(null!=a){for(;a.firstChild;)a.removeChild(a.firstChild);a.style.display="none"}},_showResultTable:function(a){var b=
    this,c=this._getTableResultDivElement(),d=this._getTableResultBodyElement(),e=this._getTableResultHeadElement();null!=c&&null!=d&&null!=e&&0<h.length&&(this._removeResultTable(),a.forEach(function(a,c){if(0==c){var g=document.createElement("tr");Object.keys(h).forEach(function(b,c){if((null==h[b].isImage||0==h[b].isImage)&&null!=a[h[b].valor]||1==h[b].isImage){var d=document.createElement("th");d.setAttribute("scope","col");d.innerHTML=h[b].titulo;1==h[b].isImage&&(d.style.textAlign="center");g.appendChild(d)}});
    e.appendChild(g)}var t=document.createElement("tr"),f=0;Object.keys(h).forEach(function(d,e){if((null==h[d].isImage||0==h[d].isImage)&&null!=a[h[d].valor]||1==h[d].isImage){var g=document.createElement("td");g.classList.add("massimp-attribute-"+h[d].valor);var l=document.createElement("span");if(1==h[d].isImage){g.style.textAlign="center";l=document.createElement("a");l.setAttribute("href","javascript:void(0);");l.classList.add("lightbox");l.id="lightbox-"+c.toString()+"-"+f.toString();var k=document.createElement("img");
    k.id="massimp-anchorimg-"+c.toString()+"-"+f.toString();var m=document.createElement("span");m.style.cursor="pointer";m.style.color="white";m.style.position="absolute";m.style.right="20px";m.style.top="20px";m.style.fontSize="70px";m.setAttribute("title",b._getStringList().close);m.innerHTML="&#10008;";m.onclick=function(){location.href="#_"};l.appendChild(m);l.appendChild(k);k=document.createElement("img");k.id="massimp-image-"+c.toString()+"-"+f.toString();k.style.display="none";k.style.objectFit=
    "contain";k.style.width="65px";k.style.cursor="pointer";k.classList.add("responsive-img");k.classList.add("massimp-img-thumbnail");k.onclick=function(){var a="lightbox"+this.id.substr(13,this.id.length);location.href="#"+a};var n=document.createElement("input");m=document.createElement("button");var p=document.createElement("button");n.setAttribute("type","file");n.setAttribute("accept","image/*");n.style.display="none";n.id="massimp-input-"+c.toString()+"-"+f.toString();n.onchange=function(a){a=
    n.id.substr(0,8)+"anchorimg"+n.id.substr(13,n.id.length);var c=document.getElementById(a);a=n.id.substr(0,8)+"image"+n.id.substr(13,n.id.length);var d=document.getElementById(a);a=n.id.substr(0,8)+"button"+n.id.substr(13,n.id.length);var e=document.getElementById(a);a=n.id.substr(0,8)+"clear-button"+n.id.substr(13,n.id.length);a=document.getElementById(a);if(0<n.files.length){var g=new FileReader;g.onload=function(a){e.innerHTML=b._getStringList().change;d.setAttribute("src",a.target.result);d.setAttribute("title",
    n.files[0].name);c.setAttribute("src",a.target.result)};g.readAsDataURL(n.files[0]);d.style.display=null;a.style.display=null}else e.innerHTML=b._getStringList().open,d.removeAttribute("src"),d.style.display="none",a.style.display="none"};m.setAttribute("type","button");m.classList.add("btn");m.id="massimp-button-"+c.toString()+"-"+f.toString();m.innerHTML=b._getStringList().open;m.onclick=function(){var a=this.id.substr(0,8)+"input"+this.id.substr(14,this.id.length);document.getElementById(a).click()};
    p.setAttribute("type","button");p.setAttribute("title",b._getStringList().remove);p.classList.add("btn-flat");p.classList.add("red-text");p.id="massimp-clear-button-"+c.toString()+"-"+f.toString();p.innerHTML="&#10006;";p.style.display="none";p.onclick=function(){var a=p.id.substr(0,8)+"input"+p.id.substr(20,p.id.length);a=document.getElementById(a);var c=p.id.substr(0,8)+"image"+p.id.substr(20,p.id.length);c=document.getElementById(c);var d=p.id.substr(0,8)+"button"+p.id.substr(20,p.id.length);d=
    document.getElementById(d);var e=a.parentNode;document.tempForm=document.createElement("form");document.tempForm.appendChild(a);document.tempForm.reset();e.appendChild(document.tempForm.childNodes[0]);c.removeAttribute("src");c.style.display="none";d.innerHTML=b._getStringList().open;p.style.display="none"};g.appendChild(l);g.appendChild(k);g.appendChild(document.createElement("br"));g.appendChild(n);g.appendChild(m);g.appendChild(document.createElement("br"));g.appendChild(p)}else l.innerHTML=a[h[d].valor],
    g.appendChild(l);t.appendChild(g);f++}});d.appendChild(t)}),c.style.display=null,u=!1)},_removeResultTable:function(){var a=this._getTableResultDivElement(),b=this._getTableResultBodyElement(),c=this._getTableResultHeadElement();if(null!=a&&null!=b){for(;c.firstChild;)c.removeChild(c.firstChild);for(;b.firstChild;)b.removeChild(b.firstChild);a.style.display="none"}},_processImages:function(a){var b=this;a=void 0===a?null:a;this._process(!1,function(c){var d=b._getTableResultBodyElement();null!=d&&
    c.forEach(function(a,b){var c=d.childNodes[b];c.querySelectorAll("td").forEach(function(b,d){Array.from(b.classList).filter(function(b,c){var d=!0;Object.keys(a).forEach(function(a,c){if(b.substr(18,b.length)==a)return d=!1});return d}).forEach(function(b,d){var e=c.getElementsByClassName(b)[0].getElementsByTagName("input")[0];null!=e&&0<e.files.length?a[b.substr(18,b.length)]=e.files[0]:a[b.substr(18,b.length)]=null})})});var e=!1;c.forEach(function(a,b){Object.keys(a).forEach(function(b,c){if(null!=
    a[b])return e=!0,!1});if(e)return!1});if(e&&null!=a&&"function"===typeof a)u=!0,b._removeResultTable(),a(c);else if(!e)throw b._getStringList().noDataProcessed;})},_process:function(a,b){a=void 0===a?!0:a;b=void 0===b?null:b;var c=this._getInputFileElement();if(null!=c&&0<c.files.length){var d=[],e=!1;a||(e=!0);c=this._getTableBodyElement();if(null!=c){var g=[];NodeList.prototype.forEach=Array.prototype.forEach;c.childNodes.forEach(function(a,b){var c=a.getElementsByClassName("massimp-attribute-col")[0].getElementsByTagName("select")[0].value;
    if(0!=c){e||(e=!0);var d={from:b,to:c};E&&(d={from:a.getElementsByClassName("massimp-column-col")[0].getElementsByTagName("span")[0].innerHTML,to:c});g.push(d)}});e&&w[A].conteudo.forEach(function(a,b){var c=x(a,g);Object.keys(c).forEach(function(a,b){g.find(function(b){return b.to==a})||delete c[a]});h.forEach(function(a,b){null==a.valor||null!=c[a.valor]||null!=a.isImage&&0!=a.isImage||(c[a.valor]=null)});d.push(c)})}if(e&&null!=b&&"function"===typeof b)b(d);else if(!e)throw this._getStringList().noAttributeAssociated;
    }else throw this._getStringList().noFileSet;},_onError:function(a){if(null!=this.options&&null!=this.options.onError&&"function"===typeof this.options.onError)this.options.onError(a);else console.error(a)}});try{b.get(this)._loadHTML();null!=d&&null!=d.language&&"string"===typeof d.language&&(Object.keys(y).includes(d.language.toLowerCase())?z=d.language:b.get(this)._onError(b.get(this)._getStringList().languageNotSupported));if(null!=d&&null!=d.attributes&&"object"===typeof d.attributes){Object.keys(d.attributes).forEach(function(a,
    b){var c=!0;"NaN"===typeof parseInt(a)&&(c=!1);var e={valor:"",titulo:"",isImage:!1};null!=d.attributes[c?b:a].valor&&(e.valor=d.attributes[c?b:a].valor);null!=d.attributes[c?b:a].titulo&&(e.titulo=d.attributes[c?b:a].titulo);null!=d.attributes[c?b:a].isImage&&(e.isImage=d.attributes[c?b:a].isImage);h.push(e)});for(var l=[],f=0;f<h.length;f++){var q=G(h,h[f].valor,"valor");1<q.length&&q.forEach(function(a,b){0<b&&(l.includes(a)||l.push(a))})}l.forEach(function(a,b){delete h[a]})}var F=function(a){try{var c=
    a.parentNode;document.tempForm=document.createElement("form");document.tempForm.appendChild(a);document.tempForm.reset();c.appendChild(document.tempForm.childNodes[0]);b.get(e)._removeResultTable();b.get(e)._removeColumnAssociationTable();var d=b.get(e)._getInputFileInsideTextElement();null!=a&&(d.removeAttribute("readonly"),d.classList.remove("valid"),d.classList.remove("invalid"),d.value=null);b.get(e)._getClearInputFileGroupElement().style.display="none";b.get(e)._getSheetsRadioElements().style.display=
    "none";b.get(e)._getRadioElements().forEach(function(a,b){a.removeAttribute("disabled")});b.get(e)._getDefaultButtonElement().style.display="none";var f=b.get(e)._getRadioHasHeaderElement(),l=JSON.parse(f.value);w=null;A=0;E=l;u=!1;v=!0}catch(m){b.get(e)._onError(m)}},D=b.get(this)._getStringList().list;null!=b.get(this).options&&null!=b.get(this).options.inputFileText&&"string"===typeof b.get(this).options.inputFileText&&(D=b.get(this).options.inputFileText);var H=b.get(this)._getStringList().fileChoose;
    null!=d&&null!=d.inputFileInsideText&&"string"===typeof d.inputFileInsideText&&(H=d.inputFileInsideText);var B=b.get(this)._getInputFileElement();B.onchange=function(){try{if(null!=B.files[0]){b.get(e)._removeColumnAssociationTable();b.get(e)._removeResultTable();var a=b.get(e)._getInputFileInsideTextElement();a.setAttribute("readonly",!0);a.classList.remove("invalid");a.classList.add("valid");a.value=B.files[0].name;b.get(e)._getClearInputFileGroupElement().style.display=null;var c=b.get(e)._getRadioHasHeaderElement(),
    f=JSON.parse(c.value);b.get(e)._processFile(B,f,function(a){b.get(e)._showColumnAssociationTable(f,0);var c=5;null!=d&&null!=d.maxVerticalRowsToDisplay&&"number"===typeof d.maxVerticalRowsToDisplay&&(c=d.maxVerticalRowsToDisplay);e.setMaxVerticalRowsToDisplay(c);1<a.length&&b.get(e)._showSheetSelection(a,function(){A=parseInt(radPlanilha.value);b.get(e)._showColumnAssociationTable(f,sheetIndex);var a=5;null!=d&&null!=d.maxVerticalRowsToDisplay&&"number"===typeof d.maxVerticalRowsToDisplay&&(a=d.maxVerticalRowsToDisplay);
    e.setMaxVerticalRowsToDisplay(a)});b.get(e)._getRadioElements().forEach(function(a,b){a.setAttribute("disabled",!0)});b.get(e)._getDefaultButtonElement().style.display=null});w=null;A=0;E=f;u=!1;v=!0}else F(B)}catch(L){b.get(e)._onError(L)}};b.get(this)._getClearInputFileElement().onclick=function(){try{var a=b.get(e)._getInputFileElement();F(a)}catch(g){b.get(e)._onError(g)}};this.setInputFileInsideText(H);this.setInputFileText(D);f=5;null!=d&&null!=d.maxVerticalRowsToDisplay&&"number"===typeof d.maxVerticalRowsToDisplay&&
    (f=d.maxVerticalRowsToDisplay);this.setMaxVerticalRowsToDisplay(f);f="blue";null!=d&&null!=d.colorButtonClass&&"string"===typeof d.colorButtonClass&&(f=d.colorButtonClass);var C=b.get(this)._getStringList().defaultButtonText;null!=d&&null!=d.buttonText&&"string"===typeof d.buttonText&&(C=d.buttonText);q=function(){try{u?b.get(e)._process(!1,function(a){b.get(e)._showResultTable(a);v=!1}):v?b.get(e)._process(!0,null):b.get(e)._processImages(null)}catch(a){b.get(e)._onError(a)}};null!=d&&null!=d.onButtonClicked&&
    "function"===typeof d.onButtonClicked&&(q=function(){try{u?b.get(e)._process(!1,function(a){b.get(e)._showResultTable(a);v=!1}):v?b.get(e)._process(!0,d.onButtonClicked):b.get(e)._processImages(d.onButtonClicked)}catch(a){b.get(e)._onError(a)}});this.setColorButtonClass(f);this.setButtonText(C);var I=b.get(this)._getDefaultButtonElement();I.onclick=q;I.style.display="none";C=!1;null!=d&&null!=d.showExtraButton&&"boolean"===typeof d.showExtraButton&&(C=d.showExtraButton);this.setShowExtraButton(C)}catch(a){b.get(this)._onError(a)}};
    q.prototype.setInputFileText=function(c){c=void 0===c?b.get(this)._getStringList().list:c;try{var d=b.get(this)._getInputFileTextElement();null!=c&&"string"===typeof c&&0<c.length&&(d.innerHTML=c)}catch(e){b.get(this)._onError(e)}};q.prototype.setInputFileInsideText=function(c){c=void 0===c?b.get(this)._getStringList().fileChoose:c;try{var d=b.get(this)._getInputFileInsideTextElement();null!=c&&(d.placeHolder=c)}catch(e){b.get(this)._onError(e)}};q.prototype.setMaxVerticalRowsToDisplay=function(c,
    d){c=void 0===c?5:c;d=void 0===d?!1:d;try{var e=446;if(null!=c&&"number"===typeof c){var f=b.get(this)._getTableBodyElement().getElementsByTagName("tr").length;e=d&&c>=f?127+75*(f-1):127+75*(c-1)}b.get(this)._getTableDivElement().style.maxHeight=e.toString()+"px"}catch(J){b.get(this)._onError(J)}};q.prototype.getNumberOfObjects=function(){var c=0;try{null!=w&&(c=w[A].conteudo.length)}catch(d){b.get(this)._onError(d)}return c};q.prototype.setColorButtonClass=function(c){c=void 0===c?"blue":c;try{var d=
    b.get(this)._getDefaultButtonElement();null!=c&&"string"===typeof c&&0<c.length&&(d.removeAttribute("class"),d.classList.add("btn"),d.classList.add("waves-effect"),d.classList.add("waves-light"),d.classList.add("massimp-default-button"),d.classList.add(c))}catch(e){b.get(this)._onError(e)}};q.prototype.setButtonText=function(c){c=void 0===c?b.get(this)._getStringList().defaultButtonText:c;try{var d=b.get(this)._getDefaultButtonElement();null!=c&&"string"===typeof c&&0<c.length&&(d.innerHTML=c)}catch(e){b.get(this)._onError(e)}};
    q.prototype.setColorExtraButtonClass=function(c){c=void 0===c?"red":c;try{var d=b.get(this)._getExtraButtonElement();null!=c&&"string"===typeof c&&0<c.length&&(d.removeAttribute("class"),d.classList.add("btn"),d.classList.add("waves-effect"),d.classList.add("waves-light"),d.classList.add("massimp-extra-button"),d.classList.add(c))}catch(e){b.get(this)._onError(e)}};q.prototype.setExtraButtonText=function(c){c=void 0===c?b.get(this)._getStringList().extraButtonText:c;try{var d=b.get(this)._getExtraButtonElement();
    null!=c&&"string"===typeof c&&0<c.length&&(d.innerHTML=c)}catch(e){b.get(this)._onError(e)}};q.prototype.setShowExtraButton=function(c){c=void 0===c?!1:c;try{var d=b.get(this)._getButtonsGroupElement(),e=b.get(this)._getExtraButtonElement();if(null!=e&&(d.removeChild(e),c)){var f=document.createElement("button");f.setAttribute("type","button");f.classList.add("btn");f.classList.add("red");f.classList.add("waves-effect");f.classList.add("waves-light");f.classList.add("massimp-extra-button");f.innerHTML=
    b.get(this)._getStringList().extraButtonText;d.appendChild(f);c="red";null!=b.get(this).options&&null!=b.get(this).options.colorExtraButtonClass&&"string"===typeof b.get(this).options.colorExtraButtonClass&&(c=b.get(this).options.colorExtraButtonClass);var h=b.get(this)._getStringList().extraButtonText;null!=b.get(this).options&&null!=b.get(this).options.extraButtonText&&"string"===typeof b.get(this).options.extraButtonText&&(h=b.get(this).options.extraButtonText);d=null;null!=b.get(this).options&&
    null!=b.get(this).options.onExtraButtonClicked&&"function"===typeof b.get(this).options.onExtraButtonClicked&&(d=b.get(this).options.onExtraButtonClicked);b.get(this)._setColorExtraButtonClass(c);b.get(this)._setExtraButtonText(h);f.onclick=d}}catch(K){b.get(this)._onError(K)}};q.prototype.processMassiveImport=function(c){var d=this;c=void 0===c?null:c;try{u?b.get(this)._process(!1,function(c){b.get(d)._showResultTable(c);v=!1}):v?b.get(this)._process(!0,c):b.get(this)._processImages(c)}catch(e){b.get(this)._onError(e)}};
    return q}(),massimpMainFunction=function(f,r,x,G){f=void 0===f?{}:f;r=void 0===r?null:r;x=!1;thisElement=this;null!=this[0]&&(thisElement=this[0],x=!0);if("object"===typeof f)null==thisElement._massimp&&(thisElement._massimp=new Massimp(thisElement,f));else if(x&&"string"===typeof f&&null!=thisElement._massimp)if("setInputFileText"==f)thisElement._massimp.setInputFileText(r);else if("setInputFileInsideText"==f)thisElement._massimp.setInputFileInsideText(r);else if("setMaxVerticalRowsToDisplay"==f)thisElement._massimp.setMaxVerticalRowsToDisplay(r);
    else{if("getNumberOfObjects"==f)return thisElement._massimp.getNumberOfObjects();"setColorButtonClass"==f?thisElement._massimp.setColorButtonClass(r):"setButtonText"==f?thisElement._massimp.setButtonText(r):"setColorExtraButtonClass"==f?thisElement._massimp.setColorExtraButtonClass(r):"setExtraButtonText"==f?thisElement._massimp.setExtraButtonText(r):"setShowExtraButton"==f?thisElement._massimp.setShowExtraButton(r):"processMassiveImport"==f?thisElement._massimp.processMassiveImport(function(f){$(thisElement).trigger("after.mp.process",
    [f])}):console.error("Massimp error: Method not found")}else console.error("Massimp error: Invalid initialization")};null!=window.jQuery&&($.fn.massimp=massimpMainFunction);HTMLElement.prototype.massimp=massimpMainFunction;